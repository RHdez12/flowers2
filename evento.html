<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reserva de Eventos</title>

    <!-- Favicon -->
    <link href="img/favicon.ico" rel="icon">
    <link rel="icon" type="image/x-icon" href="favicon.ico">

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet"> 

    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">

    <!-- Libraries Stylesheet -->
    <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">
    <link href="lib/tempusdominus/css/tempusdominus-bootstrap-4.min.css" rel="stylesheet" />

    <!-- Customized Bootstrap Stylesheet -->
    <link href="css/style.css" rel="stylesheet">
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome para iconos -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <style>
        body {
            background-color: #f8f9fa;
            background: url('img/fondo.jpg') no-repeat center center fixed;
            background-size: cover;
        }
        .container {
            max-width: 600px;
            margin-top: 50px;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
        }
        .btn-custom {
            background-color: #ff4081;
            color: white;
        }
        .btn-custom:hover {
            background-color: #d1356e;
        }
        .logout-btn {
            background-color: red;
            color: white;
            padding: 3px 8px;
            border: none;
            cursor: pointer;
            border-radius: 5px;
            margin-left: 10px;
            font-size: 0.8em;
        }
    </style>
</head>
<body onload="verificarSesion()">
      <!-- Topbar Start -->
      <div class="container-fluid bg-light pt-3 d-none d-lg-block">
    </div>
    <!-- Topbar End -->
 <!-- Navbar Start -->
<div class="container-fluid position-relative nav-bar p-0">
    <div class="container-lg position-relative p-0 px-lg-3" style="z-index: 9;">
        <nav class="navbar navbar-expand-lg bg-light navbar-light shadow-lg py-3 py-lg-0 pl-3 pl-lg-5">
            <a href="" class="navbar-brand">
                <h1 class="m-0 text-primary"><span class="text-dark">GARDEN FLOWERS</span></h1>
            </a>
            <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbarCollapse">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-between px-3" id="navbarCollapse">
                <div class="navbar-nav ml-auto py-0">
                    <!-- Inicio con icono de casa -->
                    <a href="index.html" class="nav-item nav-link active">
                        <i class="fas fa-home"></i> Inicio
                    </a>
                    <!-- Eventos con icono de calendario -->
                    <a href="evento.html" class="nav-item nav-link">
                        <i class="fas fa-calendar-alt"></i> Eventos
                    </a>
                    <!-- Catálogo con icono de lista -->
                    <a href="catalogo.html" class="nav-item nav-link">
                        <i class="fas fa-list"></i> Catálogo
                    </a>
                    <!-- Contacto con icono de sobre -->
                    <a href="contact.html" class="nav-item nav-link">
                        <i class="fas fa-envelope"></i> Contacto
                    </a>
                    <!-- Sesión o Cerrar Sesión (dinámico) -->
                    <div id="sesion-nav">
                        <!-- El contenido se actualizará con JavaScript -->
                    </div>
                </div>
            </div>
        </nav>
    </div>
</div>
<!-- Navbar End -->

    <div class="container">
        <h2 class="text-center mb-4"><i class="fa-solid fa-calendar-check"></i> Decoración de Eventos </h2>
        
        <form id="eventoForm">
           
            <div class="mb-3">
                <label class="form-label">Tipo de evento:</label>
                <select id="tipoEvento" class="form-select" onchange="mostrarCampoOtro()" required>
                    <option value="cumpleaños">Cumpleaños</option>
                    <option value="boda">Boda</option>
                    <option value="aniversario">Aniversario</option>
                    <option value="otro">Otro</option>
                </select>
                <div class="invalid-feedback">Debe seleccionar un tipo de evento.</div>
                <input type="text" id="otroEvento" class="form-control mt-2" placeholder="Especifique otro tipo de evento" style="display: none;">
                <div class="invalid-feedback">Debe ingresar un nombre válido para el evento.</div>
            </div>

            <div class="mb-3">
                <label for="direccion" class="form-label">Dirección</label>
                <input type="text" class="form-control" id="direccion" placeholder="Ingrese la dirección" required>
                <div class="invalid-feedback">Debe ingresar una dirección.</div>
            </div>

            <div class="mb-3">
                <label class="form-label">Fecha del evento:</label>
                <input type="date" id="fechaEvento" class="form-control" required>
                <div class="invalid-feedback">Debe seleccionar una fecha válida.</div>
            </div>

            <div class="mb-3">
                <label class="form-label">Número de invitados:</label>
                <input type="number" id="invitados" class="form-control" min="1" max="99999" required>
                <div class="invalid-feedback">Debe ingresar un número válido de invitados (máximo 5 dígitos).</div>
            </div>

            <div class="mb-3">
                <label class="form-label">Decoración del evento:</label><br>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="checkbox" value="globos" id="globos">
                    <label class="form-check-label" for="globos">Globos</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="checkbox" value="rosas" id="rosas">
                    <label class="form-check-label" for="rosas">Rosas</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="checkbox" value="tulipanes" id="tulipanes">
                    <label class="form-check-label" for="tulipanes">Tulipanes</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="checkbox" value="gerberas" id="gerberas">
                    <label class="form-check-label" for="gerberas">Gerberas</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="checkbox" value="orquideas" id="orquideas">
                    <label class="form-check-label" for="orquideas">Orquídeas</label>
                </div>
            </div>

            <div class="mb-3">
                <label class="form-label">Comentarios adicionales:</label>
                <textarea id="comentarios" class="form-control" rows="3" placeholder="Escribe detalles adicionales"></textarea>
                <div class="invalid-feedback">Debe ingresar comentarios válidos (letras y números, sin caracteres especiales).</div>
            </div>

            <button type="submit" class="btn btn-custom w-100"><i class="fa-solid fa-check"></i> Reservar Evento</button>
        </form>

        <!-- Mensaje de confirmación -->
        <div id="mensajeConfirmacion" class="alert alert-success mt-3 text-center" style="display: none;">
            <i class="fa-solid fa-circle-check"></i> ¡Reserva realizada con éxito!
        </div>
    </div>

    <!-- Bootstrap JS y jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // Función para verificar la sesión y actualizar el menú
    function verificarSesion() {
        const usuarioLogueado = localStorage.getItem("loggedInUser");
        const sesionNav = document.getElementById("sesion-nav");

        if (usuarioLogueado) {
            // Si el usuario está autenticado, mostrar "Cerrar Sesión"
            sesionNav.innerHTML = `
                <a href="#" class="nav-item nav-link" onclick="cerrarSesion()">
                    <i class="fas fa-sign-out-alt"></i> Cerrar Sesión
                </a>
            `;
        } else {
            // Si el usuario no está autenticado, mostrar "Sesión"
            sesionNav.innerHTML = `
                <a href="login.html" class="nav-item nav-link">
                    <i class="fas fa-user"></i> Sesión
                </a>
            `;
        }
    }

    // Función para cerrar sesión
    function cerrarSesion() {
        localStorage.removeItem("loggedInUser");
        window.location.href = "login.html";
    }

    // Llamar a la función al cargar la página
    document.addEventListener("DOMContentLoaded", function () {
        verificarSesion();
    });

        function mostrarCampoOtro() {
            const tipoEvento = document.getElementById('tipoEvento').value;
            const otroEvento = document.getElementById('otroEvento');
            if (tipoEvento === 'otro') {
                otroEvento.style.display = 'block';
                otroEvento.setAttribute('required', 'required');
            } else {
                otroEvento.style.display = 'none';
                otroEvento.removeAttribute('required');
            }
        }

        function validarFecha() {
            const fechaEvento = document.getElementById('fechaEvento').value;
            const fechaActual = new Date().toISOString().split('T')[0];

            if (fechaEvento < fechaActual) {
                alert("Debe seleccionar una fecha válida.");
                return false;
            }

            return true;
        }

        function validarFormulario() {
            const tipoEvento = document.getElementById('tipoEvento').value;
            const otroEvento = document.getElementById('otroEvento').value;
            const invitados = document.getElementById('invitados').value;
            const comentarios = document.getElementById('comentarios').value;

            if (tipoEvento === 'otro' && (!otroEvento || !/^[a-zA-Z\s]{1,50}$/.test(otroEvento))) {
                alert("Debe ingresar un nombre válido para el evento (sin números ni caracteres especiales, máximo 50 caracteres).");
                return false;
            }

            if (!/^\d{1,5}$/.test(invitados)) {
                alert("Debe ingresar un número válido de invitados (máximo 5 dígitos).");
                return false;
            }

            if (comentarios && !/^[a-zA-Z0-9\s]+$/.test(comentarios)) {
                alert("Debe ingresar comentarios válidos (letras y números, sin caracteres especiales).");
                return false;
            }

            return validarFecha();
        }

        $(document).ready(function() {
            $("#eventoForm").submit(function(event) {
                event.preventDefault(); // Evita el envío real del formulario

                if (!validarFormulario()) {
                    return;
                }

                // Muestra el mensaje de confirmación
                $("#mensajeConfirmacion").fadeIn();

                // Borra los campos del formulario después de la reserva
                $("#eventoForm")[0].reset();
                mostrarCampoOtro(); // Ocultar el campo "Otro" si estaba visible

                // Oculta el mensaje después de 3 segundos
                setTimeout(function() {
                    $("#mensajeConfirmacion").fadeOut();
                }, 3000);
            });
        });
    </script>
    <script src="js/login.js"></script>
</body>
</html>